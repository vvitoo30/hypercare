<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hypercare Dashboard</title>

    <!-- Bootstrap CSS --><link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <!-- NEW: Bootstrap Icons (for the back arrow in the modal) --><link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />

    <!-- Google Font: Poppins --><link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <!-- Custom CSS (Copied from other files + new styles) --><style>
      /* --- BASE STYLES --- */
      body {
        font-family: "Poppins", sans-serif;
        /* Use your new base color */
        background-color: #f4f6ff;
      } /* <-- FIXED: Added missing } */

      /* NEW: Blurred background for modals */
      .modal-open {
        /* This class is added by Bootstrap when a modal is open */
        overflow: hidden;
      }
      .modal-backdrop-blur {
        backdrop-filter: blur(15px);
        background-color: rgba(0, 0, 0, 0.3);
        /* THIS IS THE FIX! 
          We must override Bootstrap's default opacity of 0.5,
          which washes out the backdrop-filter.
        */
        opacity: 1;
        transition: backdrop-filter 0.15s linear;
      }

      /* --- COLORS --- */
      .bg-dark-custom {
        background-color: #1c1c3a;
      }

      .text-primary-custom {
        color: #4a43d1;
      }

      /* --- BUTTON STYLES (for reusing) --- */
      .btn-primary-custom {
        background-color: #6a60e9;
        border-color: #6a60e9;
      }
      .btn-primary-custom:hover {
        /* A slightly darker hover state */
        background-color: #584fc9;
        border-color: #584fc9;
      }
      .btn-outline-primary-custom {
        border-color: #6a60e9;
        color: #6a60e9;
      }
      .btn-outline-primary-custom:hover {
        background-color: #6a60e9;
        border-color: #6a60e9;
        color: #ffffff;
      }

      /* --- NEW: Custom white button for modals --- */
      .btn-light-custom {
        background-color: #ffffff;
        color: #1c1c3a; /* Dark text */
        border-color: #ffffff;
        padding-top: 0.75rem;
        padding-bottom: 0.75rem;
      }
      .btn-light-custom:hover {
        background-color: #f0f0f0;
        border-color: #f0f0f0;
        color: #1c1c3a;
      }

      /* --- NEW: Custom Red Logout Button --- */
      .btn-danger-custom {
        background-color: #dc3545; /* Bootstrap's standard red */
        border-color: #dc3545;
        color: #000000; /* Black text */
        font-weight: bold;
      }
      .btn-danger-custom:hover {
        background-color: #bb2d3b; /* A darker red */
        border-color: #b02a37;
        color: #000000;
        font-weight: bold;
      }

      /* --- NEW: 6-TILE STYLES --- */
      .app-tile {
        background: #ffffff;
        border-radius: 1rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.07);
        /* Set a fixed size for the tile */
        width: 120px;
        height: 120px;
        /* Use flexbox to center the image inside the tile */
        display: flex;
        align-items: center;
        justify-content: center;
        /* Center the tile itself horizontally */
        margin: 0 auto;
      }

      .app-tile:hover {
        /* Add a subtle hover effect */
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }

      /* --- NEW: MEDICATION CARD STYLES --- */
      .med-card {
        background: #ffffff;
        /* Use a larger border-radius to match the design */
        border-radius: 1rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.07);
        padding: 1rem;
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
      }

      .med-img-container {
        /* Use the same purple as our primary button */
        background-color: #6a60e9;
        border-radius: 0.75rem;
        padding: 0.5rem;
        margin-right: 1rem;
        /* Stop the container from shrinking */
        flex-shrink: 0;
      }

      .med-img-container img {
        /* Control the size of the medicine box image */
        max-width: 60px;
        display: block;
      }

      /* --- CUSTOM MODAL STYLES (Updated for fixed size) --- */
      .modal-fullscreen-custom {
        background-color: #1c1c3a;
        color: #ffffff;
        /* Ensure the modal content itself is flexible to push footer down */
        display: flex;
        flex-direction: column;
        border-radius: 1rem; /* Rounded corners for the card */
      }
      .modal-fullscreen-custom .modal-header {
        border-bottom: none;
        padding: 2rem 1.5rem; /* Adjust padding for fixed size */
        position: relative; /* For the back button absolute positioning */
      }
      .modal-fullscreen-custom .modal-body {
        /* Use flex to push button to bottom */
        display: flex;
        flex-direction: column;
        padding: 1rem 1.5rem; /* Adjust padding for fixed size */
        flex-grow: 1; /* Allow body to grow and push footer */
        /* IMPORTANT: Remove overflow from here */
        /* overflow-y: auto; */
        min-height: 0; /* Fix for flexbox overflow */
      }
      .modal-fullscreen-custom .modal-footer {
        border-top: none;
        padding: 1.5rem;
        flex-shrink: 0; /* Prevent footer from shrinking */
      }
      /* Custom back button */
      .btn-back {
        color: #ffffff;
        font-size: 2rem;
        line-height: 1;
        opacity: 0.8;
        background: none;
        border: none;
        padding: 0;
        cursor: pointer;
        position: absolute; /* Absolute positioning for the back arrow */
        left: 1.5rem;
        top: 50%;
        transform: translateY(-50%);
      }
      .btn-back:hover {
        color: #ffffff;
        opacity: 1;
      }

      /* NEW: Custom modal dialog size */
      .modal-dialog-custom-size {
        /* Set explicit width and height */
        width: 720px; /* As requested */
        height: 80vh; /* CHANGED: Use 80% of viewport height */
        max-width: none; /* Override Bootstrap's max-width for dialogs */
        /* REMOVED margin: 1.75rem auto; to allow centering */
        pointer-events: all; /* Ensure clicks inside the modal work */
      }

      /* Adjust for smaller screens if the custom size is too big */
      @media (max-width: 768px) {
        .modal-dialog-custom-size {
          width: 95%; /* Make it responsive on smaller screens */
          /* REMOVED height: 90vh; (it's now the default) */
        }
        .modal-fullscreen-custom .modal-body {
          font-size: 0.9rem; /* Smaller font for small screens */
        }
        .modal-fullscreen-custom h1 {
          font-size: 2rem !important; /* Adjust heading size */
        }
        .modal-fullscreen-custom h2 {
          font-size: 1.75rem !important; /* Adjust heading size */
        }
      }

      /* --- NEW: Blood Pressure Modal Styles --- */
      .form-control-light-custom {
        /* Custom WHITE display box */
        background-color: #ffffff;
        border: none;
        color: #1c1c3a; /* Dark text inside */
        padding: 1.25rem 1rem;
        border-radius: 1rem;
        font-size: 1.25rem;
        font-weight: bold;
      }
      /* FIXED: Removed empty ruleset */

      /* --- NEW: Daily Activity Modal Styles --- */
      .activity-row {
        background-color: #f4f6ff; /* Lightest purple background */
        border-radius: 50rem; /* Pill shape */
        padding: 0.5rem 0.5rem 0.5rem 1.5rem; /* Add padding */
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }
      .activity-row p {
        margin: 0;
        color: #1c1c3a; /* Dark text */
        font-weight: bold;
      }

      /* --- NEW: Pharmacy Notes Fact Card --- */
      .fact-card {
        background-color: #ffffff;
        color: #1c1c3a; /* Dark text */
        border-radius: 1rem;
        padding: 1.25rem;
        margin-bottom: 1rem;
      }
      .fact-card h5 {
        /* Add a style for the headings in the new card */
        font-weight: bold;
        color: #4a43d1; /* Purple heading */
        margin-bottom: 0.5rem;
      }
      .fact-card p {
        margin: 0;
        font-weight: bold;
        color: #1c1c3a;
      }

      /* NEW: Edupharma Search Bar Styles */
      .search-input-group {
        position: relative;
        display: flex;
        align-items: center;
      }

      .search-input-group .form-control {
        border-radius: 1rem; /* Rounded corners for the input */
        padding: 1rem 1.5rem;
        padding-right: 3rem; /* Space for the magnifying glass */
        background-color: #ffffff;
        border: none;
        color: #1c1c3a;
        font-weight: bold;
        font-size: 1.1rem;
      }
      .search-input-group .form-control::placeholder {
        color: #a0a0b0;
      }
      .search-input-group .form-control:focus {
        box-shadow: 0 0 0 0.25rem rgba(106, 96, 233, 0.5);
      }

      .search-input-group .search-icon {
        position: absolute;
        right: 1.5rem;
        color: #6a60e9; /* Purple icon */
        font-size: 1.5rem;
      }

      /* NEW: Scrollable card list for Edupharma results */
      .scrollable-card-list {
        overflow-y: auto; /* Add scroll only to this div */
        flex-grow: 1; /* Allow it to fill the space */
        padding-right: 0.5rem; /* Space for the scrollbar */
        margin-top: 1rem;
      }

      /* --- NEW: Nutrition Label Styles --- */
      .nutrition-label {
        background-color: #ffffff;
        border: 4px solid #1c1c3a; /* Thick dark border */
        border-radius: 0.5rem;
        padding: 1rem;
        margin-bottom: 1.5rem;
        color: #1c1c3a; /* Dark text */
        font-weight: bold;
      }
      .nutrition-header {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
      }
      .nutrition-item {
        font-size: 1.25rem;
        font-weight: 700;
        margin-top: 0.5rem;
        margin-bottom: 0.5rem;
      }
      .nutrition-label p {
        margin: 0;
        font-size: 0.9rem;
      }
      hr.nutrition-line {
        border-top: 3px solid #1c1c3a;
        opacity: 1;
        margin: 0.75rem 0;
      }
    </style>
  </head>
  <body>
    <!-- ===== HEADER (Dark) - UPDATED WITH DROPDOWN ===== --><header class="bg-dark-custom p-3 shadow-sm text-light">
      <div class="container">
        <!-- Use d-flex to align items --><div class="d-flex align-items-center">
          <!-- App Title (pushes dropdown to the right) --><div class="me-auto">
            <span class="fs-4 fw-bold">Hypercare</span>
          </div>

          <!-- NEW: Dropdown Menu --><div class="dropdown">
            <!-- This is the trigger for the dropdown --><a
              href="#"
              class="d-flex align-itemsD-center text-white text-decoration-none dropdown-toggle"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              <!-- Profile Picture Placeholder --><div
                class="rounded-circle bg-light me-2"
                style="width: 40px; height: 40px"
              >
                <!-- You can replace this div with an <img> tag for a real profile pic --></div>
              <!-- Welcome Text --><div>
                <div class="small">Welcome!</div>
                <div class="fw-bold">John Doe</div>
              </div>
            </a>

            <!-- Dropdown Menu Items --><ul
              class="dropdown-menu dropdown-menu-dark text-small shadow"
              data-bs-theme="dark"
            >
              <li>
                <!-- UPDATED: Added ID and changed href --><a class="dropdown-item" href="#" id="logoutButton">Log Out</a>
              </li>
            </ul>
          </div>
          <!-- End Dropdown Menu --></div>
      </div>
    </header>

    <!-- ===== MAIN CONTENT (White) ===== --><main class="container my-4">
      <!-- --- 6-TILE GRID --- --><div class="row g-4 text-center mb-4">
        <!-- Tile 1: Daily Monitoring --><div class="col-4 text-center">
          <a
            href="#"
            class="text-decoration-none app-tile"
            data-bs-toggle="modal"
            data-bs-target="#dailyMonitoringModal"
          >
            <img
              src="assets/daily_monitoring.png"
              alt="Daily Monitoring"
              class="img-fluid"
              style="max-width: 80px"
            />
          </a>
          <p class="fw-bold text-dark mt-2" style="font-size: 0.8rem">
            Daily Monitoring
          </p>
        </div>
        <!-- Tile 2: Blood Pressure --><div class="col-4 text-center">
          <a
            href="#"
            class="text-decoration-none app-tile"
            data-bs-toggle="modal"
            data-bs-target="#bpmModal"
          >
            <img
              src="assets/bpm.png"
              alt="Blood Pressure"
              class="img-fluid"
              style="max-width: 80px"
            />
          </a>
          <p class="fw-bold text-dark mt-2" style="font-size: 0.8rem">
            Blood Pressure
          </p>
        </div>
        <!-- Tile 3: Medication Interaction --><div class="col-4 text-center">
          <a
            href="#"
            class="text-decoration-none app-tile"
            data-bs-toggle="modal"
            data-bs-target="#medInteractionModal"
          >
            <img
              src="assets/medication_interaction.png"
              alt="Medication Interaction"
              class="img-fluid"
              style="max-width: 80px"
            />
          </a>
          <p class="fw-bold text-dark mt-2" style="font-size: 0.8rem">
            Medication Interaction
          </p>
        </div>
        <!-- Tile 4: Pharmacy Notes --><div class="col-4 text-center">
          <a
            href="#"
            class="text-decoration-none app-tile"
            data-bs-toggle="modal"
            data-bs-target="#pharmacyNotesModal"
          >
            <img
              src="assets/pharmacy_notes.png"
              alt="Pharmacy Notes"
              class="img-fluid"
              style="max-width: 80px"
            />
          </a>
          <p class="fw-bold text-dark mt-2" style="font-size: 0.8rem">
            Pharmacy Notes
          </p>
        </div>
        <!-- Tile 5: Edupharma --><div class="col-4 text-center">
          <a
            href="#"
            class="text-decoration-none app-tile"
            data-bs-toggle="modal"
            data-bs-target="#edupharmaModal"
          >
            <img
              src="assets/edupharma.png"
              alt="Edupharma"
              class="img-fluid"
              style="max-width: 80px"
            />
          </a>
          <p class="fw-bold text-dark mt-2" style="font-size: 0.8rem">
            Edupharma
          </p>
        </div>
        <!-- Tile 6: Health Dashboard --><div class="col-4 text-center">
          <a
            href="#"
            class="text-decoration-none app-tile"
            data-bs-toggle="modal"
            data-bs-target="#healthDashboardModal"
          >
            <img
              src="assets/health_dashboard.png"
              alt="Health Dashboard"
              class="img-fluid"
              style="max-width: 80px"
            />
          </a>
          <p class="fw-bold text-dark mt-2" style="font-size: 0.8rem">
            Health Dashboard
          </p>
        </div>
      </div>

      <!-- --- MEDICATION LIST --- --><h2 class="my-4 fw-bold" style="color: #1c1c3a">Your Medication</h2>

      <!-- Medication Card 1 --><div class="med-card">
        <div class="med-img-container">
          <img src="assets/amlodipine.png" alt="Amlodipine" />
        </div>
        <div>
          <h5 class="fw-bold mb-0" style="color: #1c1c3a">
            Amlodipine 10 Mg
          </h5>
          <p class="text-muted mb-0" style="font-size: 0.9rem">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit.
          </p>
        </div>
      </div>

      <!-- Medication Card 2 --><div class="med-card">
        <div class="med-img-container">
          <img src="assets/amlodipine.png" alt="Amlodipine" />
        </div>
        <div>
          <h5 class="fw-bold mb-0" style="color: #1c1c3a">
            Amlodipine 10 Mg
          </h5>
          <p class="text-muted mb-0" style="font-size: 0.9rem">
            Vestibulum porttitor ultrices elementum.
          </p>
        </div>
      </div>

      <!-- Medication Card 3 --><div class="med-card">
        <div class="med-img-container">
          <img src="assets/amlodipine.png" alt="Amlodipine" />
        </div>
        <div>
          <h5 class="fw-bold mb-0" style="color: #1c1c3a">
            Amlodipine 10 Mg
          </h5>
          <p class="text-muted mb-0" style="font-size: 0.9rem">
            Proin in felis non erat blandit.
          </p>
        </div>
      </div>
    </main>

    <!--
    ==================================================================
    MODALS (Pop-ups)
    ==================================================================
    --><!-- MODAL 1: Daily Monitoring (Styled like your example) --><div
      class="modal fade"
      id="dailyMonitoringModal"
      tabindex="-1"
      aria-labelledby="dailyMonitoringModalLabel"
      aria-hidden="true"
      data-bs-backdrop-class="modal-backdrop-blur"
    >
      <!-- ADDED custom size class, REMOVED modal-fullscreen --><div class="modal-dialog modal-dialog-centered modal-dialog-custom-size">
        <div class="modal-content modal-fullscreen-custom">
          <!-- Modal Header (Back Button) --><div class="modal-header" id="dailyMonitoring_backButton">
            <button
              type="button"
              class="btn-back"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              <i class="bi bi-arrow-left fw-bold"></i>
            </button>
          </div>

          <!-- Modal Body (Content) --><div class="modal-body">
            <!-- Wrapper for all initial content --><div id="dailyMonitoring_initialView">
              <!-- Flex container for layout --><div class="d-flex flex-column h-100">
                <!-- Centered Text --><div class="text-center">
                  <h1 class="fw-bold display-5 mb-4">
                    Medication Schedule
                  </h1>
                  <h2 class="fw-bold display-6">10:15 A.M Every Day</h2>
                </div>

                <!-- Top Left Text --><p class="fs-5 mt-5 pt-3">
                  Each medication helps<br />maintain your blood pressure!
                </p>

                <!-- Bottom Right Text --><p class="fs-5 mt-auto text-end text-white-50">
                  Don't forget to take the<br />medication at the same<br />time
                  everyday!
                </p>
              </div>
            </div>

            <!-- Success View (Hidden by default) --><div
              class="d-none text-center"
              id="dailyMonitoring_successView"
            >
              <!-- This helper div vertically centers the content --><div
                class="d-flex flex-column justify-content-center align-items-center h-100"
              >
                <img
                  src="assets/check.png"
                  alt="Success"
                  class="img-fluid mb-4"
                  style="max-width: 100px"
                />
                <h2 class="fw-bold fs-1">
                  Keep it up, don't forget to take the medication
                  consistently!
                </h2>
              </div>
            </div>
          </div>

          <!-- Modal Footer (Buttons) --><div class="modal-footer">
            <!-- Initial Button --><button
              type="button"
              class="btn btn-light-custom rounded-pill fw-bold btn-lg w-100 shadow"
              id="dailyMonitoring_initialButton"
              onclick="showSuccess('dailyMonitoring')"
            >
              I Have Taken The Medicine
            </button>
            <!-- Close Button (Hidden by default) --><button
              type="button"
              class="btn btn-light-custom rounded-pill fw-bold btn-lg w-100 shadow d-none"
              id="dailyMonitoring_closeButton"
              data-bs-dismiss="modal"
            >
              Done
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- End Modal 1 --><!-- MODAL 2: Blood Pressure --><div
      class="modal fade"
      id="bpmModal"
      tabindex="-1"
      aria-labelledby="bpmModalLabel"
      aria-hidden="true"
      data-bs-backdrop-class="modal-backdrop-blur"
    >
      <div class="modal-dialog modal-dialog-centered modal-dialog-custom-size">
        <div class="modal-content modal-fullscreen-custom">
          <div class="modal-header">
            <button
              type="button"
              class="btn-back"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              <i class="bi bi-arrow-left fw-bold"></i>
            </button>
          </div>
          <div class="modal-body">
            <h1 class="fw-bold display-5 mb-4">Your Blood Pressure</h1>

            <!-- Sistolic --><div class="mb-3">
              <label class="form-label fw-bold mb-2"
                >Sistolic (mmHg)</label
              >
              <!-- Data will come from DB, '120' is a placeholder --><div class="form-control-light-custom" id="bpm_sistolic_display">
                120
              </div>
            </div>

            <!-- Diastolic --><div class="mb-4">
              <label class="form-label fw-bold mb-2"
                >Diastolic (mmHg)</label
              >
              <!-- Data will come from DB, '80' is a placeholder --><div class="form-control-light-custom" id="bpm_diastolic_display">
                80
              </div>
            </div>

            <!-- Notes --><!-- This text will be set by JavaScript --><p class="fs-5 mt-4" id="bpm_notes">
              Notes: Calculating...
            </p>

            <div class="mt-auto"></div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-light-custom rounded-pill fw-bold btn-lg w-100 shadow"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- End Modal 2 --><!-- MODAL 3: Medication Interaction --><div
      class="modal fade"
      id="medInteractionModal"
      tabindex="-1"
      aria-labelledby="medInteractionModalLabel"
      aria-hidden="true"
      data-bs-backdrop-class="modal-backdrop-blur"
    >
      <div class="modal-dialog modal-dialog-centered modal-dialog-custom-size">
        <div class="modal-content modal-fullscreen-custom">
          <div class="modal-header">
            <button
              type="button"
              class="btn-back"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              <i class="bi bi-arrow-left fw-bold"></i>
            </button>
          </div>
          <div class="modal-body">
            <h1 class="fw-bold display-5 mb-4">Medication Interaction</h1>
            <p class="fs-5">Placeholder content for Medication Interaction.</p>
            <div class="mt-auto"></div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-light-custom rounded-pill fw-bold btn-lg w-100 shadow"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- End Modal 3 --><!-- MODAL 4: Pharmacy Notes --><div
      class="modal fade"
      id="pharmacyNotesModal"
      tabindex="-1"
      aria-labelledby="pharmacyNotesModalLabel"
      aria-hidden="true"
      data-bs-backdrop-class="modal-backdrop-blur"
    >
      <div class="modal-dialog modal-dialog-centered modal-dialog-custom-size">
        <div class="modal-content modal-fullscreen-custom">
          <div class="modal-header">
            <button
              type="button"
              class="btn-back"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              <i class="bi bi-arrow-left fw-bold"></i>
            </button>
          </div>
          <!-- UPDATED: Modal Body --><div class="modal-body">
            <h1 class="fw-bold display-5 mb-4">Did you know?</h1>

            <!-- Fact Card List --><div class="fact-card">
              <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
                condimentum et tortor at fringilla.
              </p>
            </div>
            <div class="fact-card">
              <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
                condimentum et tortor at fringilla.
              </p>
            </div>
            <div class="fact-card">
              <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
                condimentum et tortor at fringilla.
              </p>
            </div>
            <div class="fact-card">
              <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
                condimentum et tortor at fringilla.
              </p>
            </div>
            <div class="fact-card">
              <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
                condimentum et tortor at fringilla.
              </p>
            </div>
            <!-- End Fact Card List --><div class="mt-auto"></div>
          </div>
          <!-- UPDATED: Modal Footer --><div class="modal-footer">
            <button
              type="button"
              class="btn btn-light-custom rounded-pill fw-bold btn-lg w-100 shadow"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- End Modal 4 --><!-- MODAL 5: Edupharma --><div
      class="modal fade"
      id="edupharmaModal"
      tabindex="-1"
      aria-labelledby="edupharmaModalLabel"
      aria-hidden="true"
      data-bs-backdrop-class="modal-backdrop-blur"
    >
      <div class="modal-dialog modal-dialog-centered modal-dialog-custom-size">
        <div class="modal-content modal-fullscreen-custom">
          <div class="modal-header">
            <button
              type="button"
              class="btn-back"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              <i class="bi bi-arrow-left fw-bold"></i>
            </button>
          </div>
          <!-- UPDATED: Modal Body for Edupharma --><div class="modal-body">
            <!-- Search View (Initial) --><div id="edupharma_searchView">
              <h1 class="fw-bold display-5 mb-4">
                Search up your medication here
              </h1>

              <div class="search-input-group mb-3">
                <input
                  type="text"
                  class="form-control form-control-lg"
                  placeholder="Search..."
                  aria-label="Search medication"
                />
                <span class="search-icon"><i class="bi bi-search"></i></span>
              </div>

              <button
                type="button"
                class="btn btn-primary-custom rounded-pill fw-bold text-white px-5 shadow ms-auto"
                id="edupharma_enterButton"
              >
                Enter
              </button>
            </div>
            <!-- End Search View -->

            <!-- Results View (Hidden) --><div class="d-none" id="edupharma_resultsView">
              <h1 class="fw-bold display-5">Search Results</h1>
              <h2 class="fw-bold fs-4 text-white-50 mb-3">
                Showing results for "Amlodipine"
              </h2>

              <!-- FIXED: This div will scroll, not the whole modal body --><div class="scrollable-card-list">
                <!-- NEW: Nutrition Label 1 -->
                <div class="nutrition-label">
                  <h2 class="nutrition-header">Description and Benefits</h2>
                  <p>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
                    condimentum et tortor at fringilla. Donec eu dui sed nibh
                    pellentesque posuere. Aenean ipsum lacus, sagittis eu
                    vulputate et, malesuada dictum mauris.
                  </p>
                  <hr class="nutrition-line" />
                  <h3 class="nutrition-item">Dosage</h3>
                  <p>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
                    condimentum et tortor at fringilla. Donec eu dui sed nibh
                    pellentesque posuere.
                  </p>
                  <hr class="nutrition-line" />
                  <h3 class="nutrition-item">Usage Instruction</h3>
                  <p>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
                    condimentum et tortor at fringilla.
                  </p>
                </div>
                <!-- END: Nutrition Label 1 -->

                <!-- NEW: Nutrition Label 2 -->
                <div class="nutrition-label">
                  <h2 class="nutrition-header">
                    Safety Information & Contraindications
                  </h2>
                  <p>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
                    condimentum et tortor at fringilla. Donec eu dui sed nibh
                    pellentesque posuere. Aenean ipsum lacus, sagittis eu
                    vulputate et, malesuada dictum mauris.
                  </p>
                  <hr class="nutrition-line" />
                  <h3 class="nutrition-item">Contraindication</h3>
                  <p>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
                    condimentum et tortor at fringilla.
                  </p>
                </div>
                <!-- END: Nutrition Label 2 -->
              </div>
              <!-- End Scrollable Div -->
            </div>
            <!-- End Results View --><div class="mt-auto"></div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-light-custom rounded-pill fw-bold btn-lg w-100 shadow"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- End Modal 5 --><!-- MODAL 6: Health Dashboard --><div
      class="modal fade"
      id="healthDashboardModal"
      tabindex="-1"
      aria-labelledby="healthDashboardModalLabel"
      aria-hidden="true"
      data-bs-backdrop-class="modal-backdrop-blur"
    >
      <div class="modal-dialog modal-dialog-centered modal-dialog-custom-size">
        <div class="modal-content modal-fullscreen-custom">
          <div class="modal-header">
            <button
              type="button"
              class="btn-back"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              <i class="bi bi-arrow-left fw-bold"></i>
            </button>
          </div>
          <div class="modal-body">
            <h1 class="fw-bold display-5 mb-4">Daily Activity Check</h1>

            <!-- Activity List --><div class="activity-row">
              <p>Take Medicine</p>
              <button
                class="btn btn-primary-custom rounded-pill fw-bold"
                onclick="toggleActivity(this)"
              >
                Done
              </button>
            </div>
            <div class="activity-row">
              <p>Exercise</p>
              <button
                class="btn btn-primary-custom rounded-pill fw-bold"
                onclick="toggleActivity(this)"
              >
                Done
              </button>
            </div>
            <div class="activity-row">
              <p>Reduce Salt</p>
              <button
                class="btn btn-primary-custom rounded-pill fw-bold"
                onclick="toggleActivity(this)"
              >
                Done
              </button>
            </div>
            <div class="activity-row">
              <p>Sleep Enough</p>
              <button
                class="btn btn-outline-primary-custom rounded-pill fw-bold"
                onclick="toggleActivity(this)"
              >
                Undone
              </button>
            </div>
            <div class="activity-row">
              <p>No Smoking</p>
              <button
                class="btn btn-outline-primary-custom rounded-pill fw-bold"
                onclick="toggleActivity(this)"
              >
                Undone
              </button>
            </div>

            <div class="mt-auto"></div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-light-custom rounded-pill fw-bold btn-lg w-100 shadow"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- End Modal 6 --><!-- UPDATED: MODAL 7: Log Out SPINNER (was logoutModal) --><div
      class="modal fade"
      id="logoutSpinnerModal"
      tabindex="-1"
      aria-labelledby="logoutSpinnerModalLabel"
      aria-hidden="true"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content bg-dark-custom text-white">
          <div class="modal-body text-center p-4">
            <h2 class="fw-bold mb-3">Logging Out...</h2>
            <p>You will be redirected shortly.</p>
            <div class="spinner-border text-light mt-2" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- End Modal 7 --><!-- NEW: MODAL 8: Log Out CONFIRMATION --><div
      class="modal fade"
      id="logoutConfirmModal"
      tabindex="-1"
      aria-labelledby="logoutConfirmModalLabel"
      aria-hidden="true"
      data-bs-backdrop-class="modal-backdrop-blur"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content bg-dark-custom text-white">
          <div class="modal-header border-0">
            <h5 class="modal-title fw-bold fs-4" id="logoutConfirmModalLabel">
              Log Out?
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to log out?</p>
          </div>
          <div class="modal-footer border-0">
            <button
              type="button"
              class="btn btn-secondary rounded-pill"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-danger-custom rounded-pill"
              id="confirmLogoutButton"
            >
              Log Out
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- End Modal 8 --><!-- Bootstrap JS Bundle --><script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <!-- NEW: JavaScript for Modals --><script>
      // This function swaps the views
      function showSuccess(modalPrefix) {
        // Get the elements
        const initialView = document.getElementById(modalPrefix + "_initialView");
        const successView = document.getElementById(modalPrefix + "_successView");
        const backButton = document.getElementById(modalPrefix + "_backButton");
        const initialButton = document.getElementById(
          modalPrefix + "_initialButton"
        );
        const closeButton = document.getElementById(modalPrefix + "_closeButton");

        // Hide the initial view
        initialView.classList.add("d-none");
        backButton.classList.add("d-none");
        initialButton.classList.add("d-none");

        // Show the success view
        successView.classList.remove("d-none");
        closeButton.classList.remove("d-none");
      }

      // NEW: Function to toggle the activity buttons
      function toggleActivity(button) {
        if (button.classList.contains("btn-outline-primary-custom")) {
          // It's "Undone" -> Make it "Done"
          button.classList.remove("btn-outline-primary-custom");
          button.classList.add("btn-primary-custom");
          button.textContent = "Done";
        } else {
          // FIXED: It's "Done" -> Make it "Undone"
          button.classList.remove("btn-primary-custom");
          button.classList.add("btn-outline-primary-custom");
          button.textContent = "Undone";
        }
      }

      // --- This part resets the modal when it's closed ---
      const dailyModal = document.getElementById("dailyMonitoringModal");
      dailyModal.addEventListener("hidden.bs.modal", function (event) {
        // Get the elements
        const initialView = document.getElementById(
          "dailyMonitoring_initialView"
        );
        const successView = document.getElementById(
          "dailyMonitoring_successView"
        );
        const backButton = document.getElementById("dailyMonitoring_backButton");
        const initialButton = document.getElementById(
          "dailyMonitoring_initialButton"
        );
        const closeButton = document.getElementById(
          "dailyMonitoring_closeButton"
        );

        // Show the initial view (reset)
        initialView.classList.remove("d-none");
        backButton.classList.remove("d-none");
        initialButton.classList.remove("d-none");

        // Hide the success view (reset)
        successView.classList.add("d-none");
        closeButton.classList.add("d-none");
      });

      // --- NEW: This part runs the BPM logic when it opens ---
      const bpmModal = document.getElementById("bpmModal");
      bpmModal.addEventListener("shown.bs.modal", function (event) {
        // 1. Get the values (we'll read the text from the placeholder divs)
        // In a real app, you would fetch this from your DB
        const sistolicEl = document.getElementById("bpm_sistolic_display");
        const diastolicEl = document.getElementById("bpm_diastolic_display");
        const notesEl = document.getElementById("bpm_notes");

        // Convert text to numbers
        const sistolic = parseInt(sistolicEl.textContent);
        const diastolic = parseInt(diastolicEl.textContent);

        // 2. Check the logic
        let note = "Notes: ";
        if (
          (sistolic === 120 && diastolic === 80) ||
          (sistolic === 110 && diastolic === 80) ||
          (sistolic === 130 && diastolic === 70)
        ) {
          note += "Your blood pressure is Normal.";
        } else if (
          sistolic > 130 ||
          diastolic > 80 ||
          (sistolic > 120 && diastolic > 70)
        ) {
          note +=
            "Your blood pressure is High. Try to rest and reduce salt consumption.";
        } else {
          note += "Your blood pressure is Low. Please consult your doctor.";
        }

        // 3. Set the notes text
        notesEl.textContent = note;
      });

      // --- UPDATED: This part handles the Log Out flow ---
      const logoutButton = document.getElementById("logoutButton");
      const logoutConfirmModal = new bootstrap.Modal(
        document.getElementById("logoutConfirmModal")
      );
      const logoutSpinnerModal = new bootstrap.Modal(
        document.getElementById("logoutSpinnerModal")
      );
      const confirmLogoutButton = document.getElementById(
        "confirmLogoutButton"
      );

      logoutButton.addEventListener("click", function (event) {
        // Stop the link from doing anything
        event.preventDefault();
        // Show the confirmation modal
        logoutConfirmModal.show();
      });

      confirmLogoutButton.addEventListener("click", function () {
        // Hide the confirmation modal
        logoutConfirmModal.hide();

        // Show the "Logging Out..." spinner modal
        logoutSpinnerModal.show();

        // Wait 3 seconds, then redirect to index.html
        setTimeout(function () {
          window.location.href = "index.html";
        }, 3000); // 3000 milliseconds = 3 seconds
      });

      // --- NEW: This part handles the Edupharma search ---
      const edupharmaEnterButton = document.getElementById(
        "edupharma_enterButton"
      );
      const edupharmaModal = document.getElementById("edupharmaModal");
      const edupharmaSearchView = document.getElementById(
        "edupharma_searchView"
      );
      const edupharmaResultsView = document.getElementById(
        "edupharma_resultsView"
      );

      edupharmaEnterButton.addEventListener("click", function () {
        // Hide the search view
        edupharmaSearchView.classList.add("d-none");
        // Show the results view
        edupharmaResultsView.classList.remove("d-none");
      });

      // Reset Edupharma modal on close
      edupharmaModal.addEventListener("hidden.bs.modal", function (event) {
        // Show the search view
        edupharmaSearchView.classList.remove("d-none");
        // Hide the results view
        edupharmaResultsView.classList.add("d-none");
      });
    </script>
  </body>
</html>

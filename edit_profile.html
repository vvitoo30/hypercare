<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Edit Profile - Hypercare</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #f4f6ff;
      }
      .bg-dark-custom {
        background-color: #1c1c3a;
      }
      .form-control-custom {
        background-color: #ffffff;
        border: 1px solid #ced4da;
        border-radius: 0.5rem;
        padding: 0.7rem;
        color: #333;
      }
      .form-control-custom:focus {
        border-color: #4a43d1;
        box-shadow: 0 0 0 0.25rem rgba(74, 67, 209, 0.25);
      }
      .btn-primary-custom {
        background-color: #4a43d1;
        border-color: #4a43d1;
        color: white;
        font-weight: bold;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
      }
      .btn-primary-custom:hover {
        background-color: #3b35a8;
        border-color: #3b35a8;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="bg-dark-custom p-3 shadow-sm">
      <div class="container">
        <div class="d-flex align-items-center justify-content-between">
          <div class="d-flex align-items-center gap-2">
            <i class="bi bi-heart-pulse-fill text-white fs-4"></i>
            <span class="fs-4 fw-bold text-white">Hypercare</span>
          </div>
          <div class="dropdown">
            <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" data-bs-toggle="dropdown">
              <div class="rounded-circle bg-secondary me-2 d-flex align-items-center justify-content-center" style="width: 35px; height: 35px; font-size:0.8rem;">U</div>
              <span class="fw-bold d-none d-sm-block" id="user-display-name">User</span>
            </a>
            <ul class="dropdown-menu dropdown-menu-dark shadow">
              <li><a class="dropdown-item" href="main.html">Back to Dashboard</a></li>
              <li><a class="dropdown-item" href="#" id="logout-button">Log Out</a></li>
            </ul>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="container py-5">
      <h2 class="fw-bold mb-4">Edit Profile</h2>
      <div class="card shadow-sm p-4">
        <form id="edit-profile-form">
          <div class="mb-3">
            <label for="profile-username" class="form-label">Username</label>
            <input type="text" class="form-control form-control-custom" id="profile-username" required>
          </div>
          <div class="mb-3">
            <label for="profile-email" class="form-label">Email (Cannot be changed)</label>
            <input type="email" class="form-control form-control-custom" id="profile-email" disabled>
          </div>
          <div class="mb-3">
            <label for="profile-phone" class="form-label">Phone Number</label>
            <input type="tel" class="form-control form-control-custom" id="profile-phone">
          </div>
          <div class="mb-3">
            <label for="profile-age" class="form-label">Age</label>
            <input type="number" class="form-control form-control-custom" id="profile-age">
          </div>
          <div class="mb-3">
            <label for="profile-location" class="form-label">Location / DOB</label>
            <input type="text" class="form-control form-control-custom" id="profile-location">
          </div>
          <div class="mb-3">
            <label for="profile-report" class="form-label">Medical Report (Read-only)</label>
            <textarea class="form-control form-control-custom" id="profile-report" rows="2" disabled></textarea>
          </div>
          <div class="mb-3">
            <label for="profile-allergies" class="form-label">Allergies (Read-only)</label>
            <input type="text" class="form-control form-control-custom" id="profile-allergies" disabled>
          </div>
          <div class="mb-3">
            <label for="profile-medication" class="form-label">Current Medication (Read-only)</label>
            <input type="text" class="form-control form-control-custom" id="profile-medication" disabled>
          </div>
          <button type="submit" class="btn btn-primary-custom">Save Changes</button>
        </form>
      </div>
    </main>

    <!-- Logout Modal (copied from other pages for consistency) -->
    <div class="modal fade" id="logoutModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-content-dark p-4 text-center">
          <div class="modal-body p-0">
            <div id="logoutConfirmContent">
              <div class="mb-4">
                <div class="mx-auto d-flex align-items-center justify-content-center rounded-circle" style="width: 80px; height: 80px; background-color: rgba(74, 67, 209, 0.1);">
                  <i class="bi bi-box-arrow-right" style="font-size: 2.5rem; color: #4a43d1;"></i>
                </div>
              </div>
              <h3 class="fw-bold mb-2">Log Out</h3>
              <p class="text-white-50 mb-4">Are you sure you want to log out?</p>
              <div class="row g-3">
                <div class="col-6">
                  <button type="button" class="btn btn-outline-light w-100 py-2 rounded-pill fw-bold" data-bs-dismiss="modal" style="border: 1px solid rgba(255,255,255,0.2);">Cancel</button>
                </div>
                <div class="col-6">
                  <button type="button" class="btn w-100 py-2 rounded-pill fw-bold" id="confirmLogoutBtn" style="background-color: #4a43d1; color: white;">Log Out</button>
                </div>
              </div>
            </div>
            <div id="logoutLoadingContent" class="d-none py-3">
               <div class="spinner-border text-light mb-3" style="width: 3rem; height: 3rem;" role="status"></div>
               <h4 class="fw-bold">Logging you out...</h4>
               <p class="text-white-50 m-0">Please be patient</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="app.js"></script>
    <script>
      const auth = firebase.auth();
      document.getElementById('logout-button').addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('logoutConfirmContent').classList.remove('d-none');
        document.getElementById('logoutLoadingContent').classList.add('d-none');
        new bootstrap.Modal(document.getElementById('logoutModal')).show();
      });

      document.getElementById('confirmLogoutBtn').addEventListener('click', () => {
        document.getElementById('logoutConfirmContent').classList.add('d-none');
        document.getElementById('logoutLoadingContent').classList.remove('d-none');
        setTimeout(() => {
            auth.signOut().then(() => window.location.href = 'index.html');
        }, 1500);
      });
    </script>
  </body>
</html>